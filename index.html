<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aubrey's RC offers high-quality remote control cars, custom builds, racing events, and expert advice for RC enthusiasts of all levels.">
    <title>Aubrey's RC - Custom RC Cars & Racing</title>
    
    <!-- Preconnect to external domains for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Core styles (load in correct order) -->

    
    <!-- Inline critical CSS to prevent FOUC (Flash of Unstyled Content) -->
    <style>
        /* Critical base styles to prevent FOUC */
        body {
            font-family: 'Open Sans', sans-serif;
            margin: 0;
            padding: 0;
            color: #333333;
            padding-top: 70px;
            line-height: 1.6;
        }
        
        .main-header {
            background-color: #1A1A1A;
            padding: 0.75rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1020;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo h1 {
            color: #FFFFFF;
            font-size: 1.75rem;
            font-weight: 700;
            margin: 0;
            line-height: 1;
            font-family: 'Rajdhani', sans-serif;
        }
        
        .logo a {
            color: inherit;
            text-decoration: none;
        }
        
        .loading-indicator {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .loading-indicator.active {
            display: flex;
        }
        
        .loader {
            width: 40px;
            height: 40px;
            border: 4px solid #dee2e6;
            border-top: 4px solid #FF4D00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        .page-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            padding: 2rem;
        }
        
        .page-loading .loader {
            margin-bottom: 1rem;
        }
        
        footer {
            background-color: #1A1A1A;
            color: white;
            padding: 3rem 1rem 2rem;
            margin-top: 3rem;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        
        .footer-section h3 {
            margin-bottom: 1rem;
            font-size: 1.3rem;
            color: white;
            font-family: 'Rajdhani', sans-serif;
        }
        
        .footer-section p {
            margin-bottom: 0.5rem;
            color: #dee2e6;
        }
        
        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .social-link {
            color: white;
            text-decoration: none;
        }
        
        .footer-bottom {
            max-width: 1200px;
            margin: 2rem auto 0;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            color: #adb5bd;
            font-size: 0.9rem;
        }
        
        /* Hero section with video background */
        .hero {
            position: relative;
            width: 100%;
            height: 60vh;
            min-height: 400px;
            overflow: hidden;
            margin-top: -70px;
            padding-top: 70px;
        }
        
        .video-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            overflow: hidden;
        }
        
        .video-background iframe {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            border: 0;
        }
        
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2;
        }
        
        .hero-content {
            position: relative;
            z-index: 3;
            color: white;
            text-align: center;
            padding-top: 120px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .hero-content h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-family: 'Rajdhani', sans-serif;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .cta-button {
            display: inline-block;
            background-color: #FF4D00;
            color: white;
            padding: 1rem 2rem;
            text-decoration: none;
            border-radius: 5px;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }
        
        .cta-button:hover {
            background-color: #e64500;
            text-decoration: none;
            color: white;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    
    <!-- Favicon -->
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
</head>
<body>
    <!-- Loading indicator for full page loading -->
    <div class="loading-indicator">
        <div class="loader"></div>
    </div>

    <!-- App Root -->
    <div id="app">
        <!-- TopBar will be rendered here by the topbar.js script -->
        
        <!-- Main content area where page content is loaded -->
        <main id="content">
            <!-- Initial loading indicator -->
            <div class="page-loading">
                <div class="loader"></div>
                <p>Loading content...</p>
            </div>
        </main>
        
        <!-- Footer will be consistent across all pages -->
        <footer>
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <p>Email: info@aubreysrc.com</p>
                    <p>Phone: (555) 123-4567</p>
                </div>
                <div class="footer-section">
                    <h3>Hours</h3>
                    <p>Mon-Fri: 10AM - 7PM</p>
                    <p>Sat-Sun: 9AM - 5PM</p>
                </div>
                <div class="footer-section">
                    <h3>Follow Us</h3>
                    <div class="social-links">
                        <a href="#" class="social-link">Facebook</a>
                        <a href="#" class="social-link">Instagram</a>
                        <a href="#" class="social-link">YouTube</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Aubrey's RC Cars. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <!-- Core Scripts -->
    <script>
        // Load the home page content immediately without waiting for TopBar
        document.addEventListener('DOMContentLoaded', () => {
            // Load the home page content first
            loadHomeContent();
            
            // Then try to initialize TopBar if the script is available
            try {
                // Check if topbar.js has been loaded
                if (typeof TopBar === 'undefined') {
                    console.warn("TopBar not available yet, loading fallback navigation");
                    // Add a simple fallback navigation if needed
                    document.querySelector('header.main-header')?.remove();
                    const fallbackNav = `
                        <header class="main-header">
                            <nav class="nav-container">
                                <div class="logo">
                                    <h1><a href="/">Aubrey's RC Cars</a></h1>
                                </div>
                                <ul class="nav-links" style="display: flex; list-style: none; gap: 2rem; margin: 0;">
                                    <li><a href="/products" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Shop</a></li>
                                    <li><a href="/custom" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Custom Builds</a></li>
                                    <li><a href="/videos" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Media</a></li>
                                    <li><a href="/racing" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Racing</a></li>
                                    <li><a href="/contact" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Contact</a></li>
                                </ul>
                                <div class="cart-icon" style="position: relative; cursor: pointer;">
                                    <span class="cart-count" style="position: absolute; top: -8px; right: -8px; background-color: #FF4D00; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">0</span>
                                    <img src="/assets/images/cart.svg" alt="Shopping Cart" style="width: 24px; height: 24px; filter: invert(1);">
                                </div>
                            </nav>
                        </header>
                    `;
                    document.querySelector('#app').insertAdjacentHTML('afterbegin', fallbackNav);
                } else {
                    // Create and render the TopBar
                    const topBar = new TopBar();
                    topBar.render();
                    
                    // Make the topBar instance available globally for other components
                    window.topBar = topBar;
                }
            } catch (error) {
                console.error("Error initializing TopBar:", error);
                                    // If TopBar fails to initialize, make sure we still have a navigation bar
                if (!document.querySelector('header.main-header')) {
                    const fallbackNav = `
                        <header class="main-header">
                            <nav class="nav-container">
                                <div class="logo">
                                    <h1>Aubrey's RC</h1>
                                </div>
                                <ul class="nav-links" style="display: flex; list-style: none; gap: 2rem; margin: 0;">
                                    <li><a href="/products" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Shop</a></li>
                                    <li><a href="/custom" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Custom Builds</a></li>
                                    <li><a href="/videos" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Media</a></li>
                                    <li><a href="/racing" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Racing</a></li>
                                    <li><a href="/contact" style="color: white; text-decoration: none; font-family: 'Rajdhani', sans-serif;">Contact</a></li>
                                </ul>
                                <div class="cart-icon" style="position: relative; cursor: pointer;">
                                    <span class="cart-count" style="position: absolute; top: -8px; right: -8px; background-color: #FF4D00; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">0</span>
                                    <img src="/assets/images/cart.svg" alt="Shopping Cart" style="width: 24px; height: 24px; filter: invert(1);">
                                </div>
                            </nav>
                        </header>
                    `;
                    document.querySelector('#app').insertAdjacentHTML('afterbegin', fallbackNav);
                }
            }
        });
        
        // Function to load the home page content
        function loadHomeContent() {
            // Get the content container
            const content = document.getElementById('content');
            
            // Replace loading indicator with home content
            content.innerHTML = `
                <section class="hero">
                    <div class="video-background">
                        <iframe
                            src="https://www.youtube.com/embed/fn02DjC0gok?autoplay=1&mute=1&start=25&loop=1&playlist=fn02DjC0gok&controls=0&showinfo=0&rel=0&modestbranding=1"
                            allow="autoplay; encrypted-media"
                            allowfullscreen
                            title="RC Car video background">
                        </iframe>
                    </div>
                    <div class="hero-overlay"></div>
                    <div class="hero-content">
                        <h1>Custom RC Cars & Trucks</h1>
                        <p>Handcrafted in Iowa, built to ignite your passion for RC adventures.</p>
                        <a href="/products" class="cta-button">Build your Custom RC</a>
                    </div>
                </section>
                
                <section style="padding: 4rem 2rem; max-width: 1200px; margin: 0 auto;">
                    <h2 style="text-align: center; margin-bottom: 2rem; font-size: 2.5rem; color: #1A1A1A; font-family: 'Rajdhani', sans-serif;">Featured RC Cars</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <div style="background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <img src="/assets/images/products/car1.jpg" alt="Traxxas Rustler" style="width: 100%; height: 250px; object-fit: cover;">
                            <div style="padding: 1.5rem;">
                                <h3 style="font-size: 1.5rem; margin-bottom: 0.5rem; font-family: 'Rajdhani', sans-serif;">Traxxas Rustler</h3>
                                <p style="margin-bottom: 1rem;">High-performance electric stadium truck</p>
                                <span style="display: block; font-weight: 600; color: #FF4D00; font-size: 1.4rem; margin-bottom: 1rem;">$299.99</span>
                                <button style="width: 100%; padding: 0.75rem; background-color: #00B8FF; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" class="add-to-cart-btn" data-id="traxxas-rustler" data-name="Traxxas Rustler" data-price="299.99" data-image="/assets/images/products/car1.jpg">Add to Cart</button>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <img src="/assets/images/products/car2.jpg" alt="Arrma Kraton" style="width: 100%; height: 250px; object-fit: cover;">
                            <div style="padding: 1.5rem;">
                                <h3 style="font-size: 1.5rem; margin-bottom: 0.5rem; font-family: 'Rajdhani', sans-serif;">Arrma Kraton</h3>
                                <p style="margin-bottom: 1rem;">1/8 Scale Monster Truck</p>
                                <span style="display: block; font-weight: 600; color: #FF4D00; font-size: 1.4rem; margin-bottom: 1rem;">$549.99</span>
                                <button style="width: 100%; padding: 0.75rem; background-color: #00B8FF; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" class="add-to-cart-btn" data-id="arrma-kraton" data-name="Arrma Kraton" data-price="549.99" data-image="/assets/images/products/car2.jpg">Add to Cart</button>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <img src="/assets/images/products/car3.jpg" alt="Losi Mini-T" style="width: 100%; height: 250px; object-fit: cover;">
                            <div style="padding: 1.5rem;">
                                <h3 style="font-size: 1.5rem; margin-bottom: 0.5rem; font-family: 'Rajdhani', sans-serif;">Losi Mini-T</h3>
                                <p style="margin-bottom: 1rem;">Compact racing truck</p>
                                <span style="display: block; font-weight: 600; color: #FF4D00; font-size: 1.4rem; margin-bottom: 1rem;">$199.99</span>
                                <button style="width: 100%; padding: 0.75rem; background-color: #00B8FF; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" class="add-to-cart-btn" data-id="losi-mini-t" data-name="Losi Mini-T" data-price="199.99" data-image="/assets/images/products/car3.jpg">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </section>
            `;
            
            // Add event listeners for the Add to Cart buttons
            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = e.target.dataset.id;
                    const productName = e.target.dataset.name;
                    const productPrice = parseFloat(e.target.dataset.price);
                    const productImage = e.target.dataset.image;
                    
                    // Add to cart using the TopBar's addToCart method
                    if (window.topBar && typeof window.topBar.addToCart === 'function') {
                        window.topBar.addToCart({
                            id: productId,
                            name: productName,
                            price: productPrice,
                            image: productImage
                        });
                    } else {
                        // Fallback if TopBar is not available
                        alert(`Added to cart: ${productName} - ${productPrice}`);
                        // Update cart count display as a visual cue
                        const cartCount = document.querySelector('.cart-count');
                        if (cartCount) {
                            const currentCount = parseInt(cartCount.textContent || '0');
                            cartCount.textContent = currentCount + 1;
                        }
                    }
                });
            });
        }
    </script>

    <!-- Include the TopBar script -->
    <script src="/assets/js/topbar.js"></script>
    
    <!-- Defer loading of SPA scripts until we're sure the basic page works -->
    <script src="/assets/js/main.js" defer></script>
    <script src="/assets/js/router.js" defer></script>
</body>
</html>